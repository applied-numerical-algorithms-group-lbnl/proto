#pragma once

#include "IMEXIntegrator.H"

/// 6 Stage 4th Order IMEX ARK Method
/**
    Implementation of the ARK4(3)6L[2]SA algorithm (See Ascher et.al. 1997)
*/
template<class IMEXOP, class IMEXDATA>
class ARK4_IMEXIntegrator : public IMEXIntegrator<IMEXOP, IMEXDATA, 6,3>
{
    void define() {

        // Diagnonal coeficient
        this->m_aIDiag = 0.25;

        // Define 1D arrays
        this->m_c = { 0.0, 0.5, 0.332, 0.62, 0.85, 1.0 };
        this->m_b =   {0.15791629516167136, 0., 0.18675894052400077, 0.6805652953093346, -0.27524053099500667, 0.25};

        // Define MD arrays
        this->m_bstar = {
            {0.961753400252887, 0., 0.787405595186356, -2.74544192086633, 3.70351728061223, -1.70723435518514},
            {-1.76418754019038, 0., -0.774504669155511, 9.64023584441292, -12.544886411271, 5.44334277620397},
            {0.960350435099165, 0., 0.173858014493155, -6.21422862823726, 8.56612859966376, -3.48610842101883}

        };
        this->m_aE = {
            {0., 0., 0., 0., 0., 0.},
            {0.5, 0., 0., 0., 0., 0.},
            {0.221776, 0.110224, 0., 0., 0., 0.},
            {-0.04884659515311857, -0.17772065232640102, 0.8465672474795197, 0., 0., 0.},
            {-0.15541685842491548, -0.3567050098221991, 1.0587258798684427, 0.30339598837867193, 0., 0.},
            { 0.2014243506726763, 0.008742057842904185, 0.15993995707168115, 0.4038290605220775, 0.22606457389066084, 0.}
        };

        this->m_aI = {
            {0., 0., 0., 0., 0., 0.},
            {0.25, 0.25, 0., 0., 0., 0.},
            {0.137776, -0.055776, 0.25, 0., 0., 0.},
            {0.14463686602698217, -0.22393190761334475, 0.4492950415863626, 0.25, 0., 0.},
            {0.09825878328356477, -0.5915442428196704, 0.8101210538282996, 0.283164405707806, 0.25, 0.},
            {0.15791629516167136, 0., 0.18675894052400077, 0.6805652953093346, -0.27524053099500667, 0.25}
        };
        this->m_defined = true;
    }
};
