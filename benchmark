#!/usr/bin/python
from argparse import *
import os
import glob
import platform
import datetime

top = os.getcwd()
now = datetime.datetime.now()
default_directory= top + '/_bench.'+ str(now.month) + "." + str(now.day) + "." + str(now.year)
print "Proto benchmarking script."
parser = ArgumentParser()
parser.add_argument('--dir', help='Directory in which to put results', default=default_directory)
parser.add_argument('--phome', help='Directory where proto_home lives', default=top)
args = parser.parse_args()

resultsdir = args.dir
proto_home = args.phome
print "putting benchmark results in " + resultsdir
if not(os.path.isdir(resultsdir)):
  os.mkdir(resultsdir)

targets=['Euler', 'Godunov', 'Multigrid', 'Navier', 'applyKernel', 'forallKernel']


for t in targets:
  exampleDir = proto_home + '/examples/' + t + '/exec'
  print exampleDir
  subdir = resultsdir + "/_" + t
  if not(os.path.isdir(subdir)):
    os.mkdir(subdir)

  os.chdir(subdir)
  
  commname = exampleDir + "/" + t + ".exe"
  print commname
  os.system(commname);
