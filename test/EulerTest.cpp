#include <cstring>
#include <string>
using std::string;
using std::to_string;

#include <gtest/gtest.h>
using namespace testing;
#include <BenchmarkTest.hpp>
//using test::BenchmarkTest;

#define PI 3.141592653589793
#define NGHOST 4
#define NUMCELLS 16

#include "Proto.H"
#include "EulerRK4.H"
#include "Proto_DataFlow.H"

#include "euler_step.h"

namespace test {
    class EulerTest : public BenchmarkTest {
    protected:
        EulerTest() {
            _name = "EulerTest";
        }

        virtual void SetUp(initializer_list<string> args) {
            _tstop= 1.0;
            _maxstep = 10;
            _outputInterval = -1;
            _nx = NUMCELLS;

            vector<string> argv(args.begin(), args.end());
            unsigned argc = argv.size();

            for(int iarg = 0; iarg < argc-1; iarg++) {
                if(strcmp(argv[iarg].c_str(),"-n") == 0) {
                    _nx = atoi(argv[iarg+1].c_str());
                } else if(strcmp(argv[iarg].c_str(), "-m") == 0) {
                    _maxstep = atoi(argv[iarg+1].c_str());
                } else if(strcmp(argv[iarg].c_str(), "-o") == 0) {
                    _outputInterval = atoi(argv[iarg+1].c_str());
                } else if(strcmp(argv[iarg].c_str(),"-t") == 0) {
                    _tstop = atof(argv[iarg+1].c_str());
                }
            }

            unsigned _nRhs = NUMCELLS;
            unsigned _nU = NUMCELLS + 2 * NGHOST;
            for (unsigned d = 1; d < DIM; d++) {
                _nRhs *= _nRhs;
                _nU *= _nU;
            }

            _rhs = (double*) calloc(_nRhs * NUMCOMPS, sizeof(double));
            _U = (double*) calloc(_nU * NUMCOMPS, sizeof(double));

            double Uinit[] = {1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,1.29546,1.14763,1.14763,1.29546,1.50454,1.65237,1.65237,1.50454,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,0.458016,0.405748,0.405748,0.458016,0.531934,0.584202,0.584202,0.531934,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941,2.40059,2.01252,2.01252,2.40059,2.94941,3.33748,3.33748,2.94941};
            for (unsigned i = 0; i < _nU * NUMCOMPS; i++) {
                _U[i] = Uinit[i];
            }
        }

        virtual void TearDown() {
            free(_rhs);
            free(_U);
        }

        double _tstop;
        int _nx, _maxstep, _outputInterval;
        unsigned _nRhs, _nU;
        double* _rhs;
        double* _U;
    };

    TEST_F(EulerTest, StepFxn) {
        SetUp({""});

        euler_step(_U, _rhs);

        int stop = 1;
    }
}