// 'euler_step' code generated by 'edavis' at 08/15/2019 17:09:15
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <math.h>
#include <string.h>
#include <cuda_funcs.h>

#define min(x,y) (((x)<(y))?(x):(y))
#define max(x,y) (((x)>(y))?(x):(y))
#define abs(x) ((x)<0?-(x):(x))
#define absmin(x,y) ((x)=min(abs((x)),abs((y))))
#define absmax(x,y) ((x)=max(abs((x)),abs((y))))
#define floord(x,y) ((x)/(y))
#define sgn(x) ((x)<0?-1:1)
#define offset2(i,j,M) ((j)+(i)*(M))
#define offset3(i,j,k,M,N) ((k)+((j)+(i)*(M))*(N))
#define offset4(i,j,k,l,M,N,P) ((l)+((k)+((j)+(i)*(M))*(N))*(P))
#define arrinit(ptr,val,size) for(unsigned __i__=0;__i__<(size);__i__++) (ptr)[__i__]=(val)
#define arrprnt(name,arr,size) {\
fprintf(stderr,"%s={",(name));\
for(unsigned __i__=0;__i__<(size);__i__++) fprintf(stderr,"%lg,",(arr)[__i__]);\
fprintf(stderr,"}\n");}
#define xmin (blockIdx.x*blockDim.x+threadIdx.x)
#define ymin (blockIdx.y*blockDim.y+threadIdx.y)
#define zmin (blockIdx.z*blockDim.z+threadIdx.z)
#define xinc (blockDim.x*gridDim.x)
#define yinc (blockDim.y*gridDim.y)
#define zinc (blockDim.z*gridDim.z)
#define C 5
#define D 3
#define G 4
#define N 64
#define T 8
#define U(c,z,y,x) U[offset4((c),(z)+4,(y)+4,(x)+4,(N+3+4+1),(N+3+4+1),(N+3+4+1))]
#define rhs(c,z,y,x) rhs[offset4((c),(z),(y),(x),(N-1+1),(N-1+1),(N-1+1))]
#define W_bar(c,z,y,x) array0[offset4((c),(z)+4,(y)+4,(x)+4,(N+3+4+1),(N+3+4+1),(N+3+4+1))]
#define u(c,z,y,x) array1[(c)]
#define W(c,z,y,x) array2[(c)]
#define W_ave(c,z,y,x) array3[offset4((c),(z)+3,(y)+3,(x)+3,(N+2+3+1),(N+2+3+1),(N+2+3+1))]
#define W_aveL_d1(c,z,y,x) array4[offset4((c),(z)+3,(y)+3,(x),(N+2+3+1),(N+2+3+1),(N+1+1))]
#define W_aveH_d1(c,z,y,x) array5[offset4((c),(z)+3,(y)+3,(x)+1,(N+2+3+1),(N+2+3+1),(N+1+1))]
#define W_ave_f_d1(c,z,y,x) array6[offset4((c),(z)+3,(y)+3,(x),(N+2+3+1),(N+2+3+1),(N+1))]
#define F_bar_f_d1(c,z,y,x) array7[offset4((c),(z)+3,(y)+3,(x),(N+2+3+1),(N+2+3+1),(N+1))]
#define W_f_d1(c,z,y,x) array8[(c)]
#define F_ave_f_d1(c,z,y,x) array9[offset4((c),(z)+2,(y)+2,(x),(N+1+2+1),(N+1+2+1),(N+1))]
#define W_aveL_d2(c,z,y,x) array10[(c)]
#define W_aveH_d2(c,z,y,x) array11[(c)]
#define W_ave_f_d2(c,z,y,x) array12[offset4((c),(z)+3,(y),(x)+3,(N+2+3+1),(N+1),(N+2+3+1))]
#define F_bar_f_d2(c,z,y,x) array13[offset4((c),(z)+3,(y),(x)+3,(N+2+3+1),(N+1),(N+2+3+1))]
#define W_f_d2(c,z,y,x) array14[(c)]
#define F_ave_f_d2(c,z,y,x) array15[offset4((c),(z)+2,(y),(x)+2,(N+1+2+1),(N+1),(N+1+2+1))]
#define W_aveL_d3(c,z,y,x) array16[(c)]
#define W_aveH_d3(c,z,y,x) array17[(c)]
#define W_ave_f_d3(c,z,y,x) array18[offset4((c),(z),(y)+3,(x)+3,(N+1),(N+2+3+1),(N+2+3+1))]
#define F_bar_f_d3(c,z,y,x) array19[offset4((c),(z),(y)+3,(x)+3,(N+1),(N+2+3+1),(N+2+3+1))]
#define W_f_d3(c,z,y,x) array20[(c)]
#define F_ave_f_d3(c,z,y,x) array21[offset4((c),(z),(y)+2,(x)+2,(N+1),(N+1+2+1),(N+1+2+1))]

typedef struct {
    double* __restrict array0;
    double* __restrict array1;
    double* __restrict array2;
    double* __restrict array3;
    double* __restrict array4;
    double* __restrict array5;
    double* __restrict array6;
    double* __restrict array7;
    double* __restrict array8;
    double* __restrict array9;
    double* __restrict array10;
    double* __restrict array11;
    double* __restrict array12;
    double* __restrict array13;
    double* __restrict array14;
    double* __restrict array15;
    double* __restrict array16;
    double* __restrict array17;
    double* __restrict array18;
    double* __restrict array19;
    double* __restrict array20;
    double* __restrict array21;
} euler_step_params;

__global__ void euler_step_(const double* U, double* rhs, euler_step_params* params) {
    int t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11,t12,t13,t14,t15;
    
    double* __restrict__ array0 = params->array0;
    double* __restrict__ array1 = params->array1;
    double* __restrict__ array2 = params->array2;
    double* __restrict__ array3 = params->array3;
    double* __restrict__ array4 = params->array4;
    double* __restrict__ array5 = params->array5;
    double* __restrict__ array6 = params->array6;
    double* __restrict__ array7 = params->array7;
    double* __restrict__ array8 = params->array8;
    double* __restrict__ array9 = params->array9;
    double* __restrict__ array10 = params->array10;
    double* __restrict__ array11 = params->array11;
    double* __restrict__ array12 = params->array12;
    double* __restrict__ array13 = params->array13;
    double* __restrict__ array14 = params->array14;
    double* __restrict__ array15 = params->array15;
    double* __restrict__ array16 = params->array16;
    double* __restrict__ array17 = params->array17;
    double* __restrict__ array18 = params->array18;
    double* __restrict__ array19 = params->array19;
    double* __restrict__ array20 = params->array20;
    double* __restrict__ array21 = params->array21;
    
// consToPrim1+deconvolve+consToPrim2+laplacian+interpL_d1+interpH_d1+upwindState1+getFlux1+deconvolve_f_d1+getFlux2+smul_d1+lap_f_d1+div_f_d1+interpL_d2+interpH_d2+upwindState2+getFlux3+deconvolve_f_d2+getFlux4+smul_d2+lap_f_d2+div_f_d2+interpL_d3+interpH_d3+upwindState3+getFlux5+deconvolve_f_d3+getFlux6+smul_d3+lap_f_d3+div_f_d3+muldx
#undef s0
#define s0(z,y,x) {\
W_bar(0,(z),(y),(x)) = U(0,(z),(y),(x));\
W_bar(1,(z),(y),(x)) = U(1,(z),(y),(x))/U(0,(z),(y),(x));\
W_bar(2,(z),(y),(x)) = U(2,(z),(y),(x))/U(0,(z),(y),(x));\
W_bar(3,(z),(y),(x)) = U(3,(z),(y),(x))/U(0,(z),(y),(x));\
W_bar(4,(z),(y),(x)) = (U(4,(z),(y),(x))-0.500000*U(0,(z),(y),(x))*(((U(1,(z),(y),(x))/U(0,(z),(y),(x)))*(U(1,(z),(y),(x))/U(0,(z),(y),(x))))+((U(2,(z),(y),(x))/U(0,(z),(y),(x)))*(U(2,(z),(y),(x))/U(0,(z),(y),(x))))+((U(3,(z),(y),(x))/U(0,(z),(y),(x)))*(U(3,(z),(y),(x))/U(0,(z),(y),(x))))))*(1.400000-1.000000);\
}
#undef s1
#define s1(c,z,y,x) u((c),(z),(y),(x))=(1.250000*U((c),(z),(y),(x)))+((-0.041667)*U((c),(z),(y),(x)+1))+((-0.041667)*U((c),(z),(y),(x)-1))+((-0.041667)*U((c),(z),(y)+1,(x)))+((-0.041667)*U((c),(z),(y)-1,(x)))+((-0.041667)*U((c),(z)+1,(y),(x)))+((-0.041667)*U((c),(z)-1,(y),(x)))
#undef s2
#define s2(z,y,x) {\
W(0,(z),(y),(x)) = u(0,(z),(y),(x));\
W(1,(z),(y),(x)) = u(1,(z),(y),(x))/u(0,(z),(y),(x));\
W(2,(z),(y),(x)) = u(2,(z),(y),(x))/u(0,(z),(y),(x));\
W(3,(z),(y),(x)) = u(3,(z),(y),(x))/u(0,(z),(y),(x));\
W(4,(z),(y),(x)) = (u(4,(z),(y),(x))-0.500000*u(0,(z),(y),(x))*(((u(1,(z),(y),(x))/u(0,(z),(y),(x)))*(u(1,(z),(y),(x))/u(0,(z),(y),(x))))+((u(2,(z),(y),(x))/u(0,(z),(y),(x)))*(u(2,(z),(y),(x))/u(0,(z),(y),(x))))+((u(3,(z),(y),(x))/u(0,(z),(y),(x)))*(u(3,(z),(y),(x))/u(0,(z),(y),(x))))))*(1.400000-1.000000);\
}
#undef s3
#define s3(c,z,y,x) W_ave((c),(z),(y),(x))=(((-0.250000)*W_bar((c),(z),(y),(x)))+(0.041667*W_bar((c),(z),(y),(x)+1))+(0.041667*W_bar((c),(z),(y),(x)-1))+(0.041667*W_bar((c),(z),(y)+1,(x)))+(0.041667*W_bar((c),(z),(y)-1,(x)))+(0.041667*W_bar((c),(z)+1,(y),(x)))+(0.041667*W_bar((c),(z)-1,(y),(x))))+W((c),(z),(y),(x))
#undef s4
#define s4(c,z,y,x) W_aveL_d1((c),(z),(y),(x))=(0.033333*W_ave((c),(z),(y),(x)-3))+((-0.050000)*W_ave((c),(z),(y),(x)+1))+((-0.216667)*W_ave((c),(z),(y),(x)-2))+(0.450000*W_ave((c),(z),(y),(x)))+(0.783333*W_ave((c),(z),(y),(x)-1))
#undef s5
#define s5(c,z,y,x) W_aveH_d1((c),(z),(y),(x))=((-0.050000)*W_ave((c),(z),(y),(x)-2))+(0.033333*W_ave((c),(z),(y),(x)+2))+(0.450000*W_ave((c),(z),(y),(x)-1))+((-0.216667)*W_ave((c),(z),(y),(x)+1))+(0.783333*W_ave((c),(z),(y),(x)))
#undef s6
#define s6(z,y,x) {\
W_ave_f_d1(0,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(0,(z),(y),(x))) : (W_aveH_d1(0,(z),(y),(x)));\
W_ave_f_d1(1,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(1,(z),(y),(x))) : (W_aveH_d1(1,(z),(y),(x)));\
W_ave_f_d1(2,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(2,(z),(y),(x))) : (W_aveH_d1(2,(z),(y),(x)));\
W_ave_f_d1(3,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(3,(z),(y),(x))) : (W_aveH_d1(3,(z),(y),(x)));\
W_ave_f_d1(4,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(4,(z),(y),(x))) : (W_aveH_d1(4,(z),(y),(x)));\
W_ave_f_d1(0,(z),(y),(x))+=(0.000000 < sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000) ? (((((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000+((((((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))*(W_aveL_d1(0+1,(z),(y),(x))-W_aveH_d1(0+1,(z),(y),(x))))*0.500000-W_ave_f_d1(4,(z),(y),(x))))/((sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000)))*sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000)))) : (0.000000);\
W_ave_f_d1(0+1,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) : (W_ave_f_d1(0+1,(z),(y),(x)));\
W_ave_f_d1(4,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000+((((((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))*(W_aveL_d1(0+1,(z),(y),(x))-W_aveH_d1(0+1,(z),(y),(x))))*0.500000) : (W_ave_f_d1(4,(z),(y),(x)));\
}
#undef s7
#define s7(z,y,x) {\
F_bar_f_d1(0,(z),(y),(x))=(W_ave_f_d1(0+1,(z),(y),(x)))*W_ave_f_d1(0,(z),(y),(x));\
F_bar_f_d1(1,(z),(y),(x))=W_ave_f_d1(1,(z),(y),(x))*F_bar_f_d1(0,(z),(y),(x));\
F_bar_f_d1(2,(z),(y),(x))=W_ave_f_d1(2,(z),(y),(x))*F_bar_f_d1(0,(z),(y),(x));\
F_bar_f_d1(3,(z),(y),(x))=W_ave_f_d1(3,(z),(y),(x))*F_bar_f_d1(0,(z),(y),(x));\
F_bar_f_d1(0+1,(z),(y),(x))+=W_ave_f_d1(4,(z),(y),(x));\
F_bar_f_d1(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_ave_f_d1(0+1,(z),(y),(x)))*W_ave_f_d1(4,(z),(y),(x))+0.500000*F_bar_f_d1(0,(z),(y),(x))*((W_ave_f_d1(1,(z),(y),(x))*W_ave_f_d1(1,(z),(y),(x)))+(W_ave_f_d1(2,(z),(y),(x))*W_ave_f_d1(2,(z),(y),(x)))+(W_ave_f_d1(3,(z),(y),(x))*W_ave_f_d1(3,(z),(y),(x))));\
}
#undef s8
#define s8(c,z,y,x) W_f_d1((c),(z),(y),(x))=(1.166667*W_ave_f_d1((c),(z),(y),(x)))+((-0.041667)*W_ave_f_d1((c),(z),(y)+1,(x)))+((-0.041667)*W_ave_f_d1((c),(z),(y)-1,(x)))+((-0.041667)*W_ave_f_d1((c),(z)+1,(y),(x)))+((-0.041667)*W_ave_f_d1((c),(z)-1,(y),(x)))
#undef s9
#define s9(z,y,x) {\
F_ave_f_d1(0,(z),(y),(x))=(W_f_d1(0+1,(z),(y),(x)))*W_f_d1(0,(z),(y),(x));\
F_ave_f_d1(1,(z),(y),(x))=W_f_d1(1,(z),(y),(x))*F_ave_f_d1(0,(z),(y),(x));\
F_ave_f_d1(2,(z),(y),(x))=W_f_d1(2,(z),(y),(x))*F_ave_f_d1(0,(z),(y),(x));\
F_ave_f_d1(3,(z),(y),(x))=W_f_d1(3,(z),(y),(x))*F_ave_f_d1(0,(z),(y),(x));\
F_ave_f_d1(0+1,(z),(y),(x))+=W_f_d1(4,(z),(y),(x));\
F_ave_f_d1(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_f_d1(0+1,(z),(y),(x)))*W_f_d1(4,(z),(y),(x))+0.500000*F_ave_f_d1(0,(z),(y),(x))*((W_f_d1(1,(z),(y),(x))*W_f_d1(1,(z),(y),(x)))+(W_f_d1(2,(z),(y),(x))*W_f_d1(2,(z),(y),(x)))+(W_f_d1(3,(z),(y),(x))*W_f_d1(3,(z),(y),(x))));\
}
#undef s10
#define s10(c,z,y,x) F_bar_f_d1((c),(z),(y),(x))*=0.041667
#undef s11
#define s11(c,z,y,x) F_ave_f_d1((c),(z),(y),(x))+=((-0.166667)*F_bar_f_d1((c),(z),(y),(x)))+(0.041667*F_bar_f_d1((c),(z),(y)+1,(x)))+(0.041667*F_bar_f_d1((c),(z),(y)-1,(x)))+(0.041667*F_bar_f_d1((c),(z)+1,(y),(x)))+(0.041667*F_bar_f_d1((c),(z)-1,(y),(x)))
#undef s12
#define s12(c,z,y,x) rhs((c),(z),(y),(x))+=((-1.000000)*F_ave_f_d1((c),(z),(y),(x)))+(1.000000*F_ave_f_d1((c),(z),(y),(x)+1))
#undef s13
#define s13(c,z,y,x) W_aveL_d2((c),(z),(y),(x))=(0.033333*W_ave((c),(z),(y)-3,(x)))+((-0.050000)*W_ave((c),(z),(y)+1,(x)))+((-0.216667)*W_ave((c),(z),(y)-2,(x)))+(0.450000*W_ave((c),(z),(y),(x)))+(0.783333*W_ave((c),(z),(y)-1,(x)))
#undef s14
#define s14(c,z,y,x) W_aveH_d2((c),(z),(y),(x))=((-0.050000)*W_ave((c),(z),(y)-2,(x)))+(0.033333*W_ave((c),(z),(y)+2,(x)))+(0.450000*W_ave((c),(z),(y)-1,(x)))+((-0.216667)*W_ave((c),(z),(y)+1,(x)))+(0.783333*W_ave((c),(z),(y),(x)))
#undef s15
#define s15(z,y,x) {\
W_ave_f_d2(0,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(0,(z),(y),(x))) : (W_aveH_d2(0,(z),(y),(x)));\
W_ave_f_d2(1,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(1,(z),(y),(x))) : (W_aveH_d2(1,(z),(y),(x)));\
W_ave_f_d2(2,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(2,(z),(y),(x))) : (W_aveH_d2(2,(z),(y),(x)));\
W_ave_f_d2(3,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(3,(z),(y),(x))) : (W_aveH_d2(3,(z),(y),(x)));\
W_ave_f_d2(4,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(4,(z),(y),(x))) : (W_aveH_d2(4,(z),(y),(x)));\
W_ave_f_d2(0,(z),(y),(x))+=(0.000000 < sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000) ? (((((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000+((((((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))*(W_aveL_d2(1+1,(z),(y),(x))-W_aveH_d2(1+1,(z),(y),(x))))*0.500000-W_ave_f_d2(4,(z),(y),(x))))/((sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000)))*sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000)))) : (0.000000);\
W_ave_f_d2(1+1,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) : (W_ave_f_d2(1+1,(z),(y),(x)));\
W_ave_f_d2(4,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000+((((((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))*(W_aveL_d2(1+1,(z),(y),(x))-W_aveH_d2(1+1,(z),(y),(x))))*0.500000) : (W_ave_f_d2(4,(z),(y),(x)));\
}
#undef s16
#define s16(z,y,x) {\
F_bar_f_d2(0,(z),(y),(x))=(W_ave_f_d2(1+1,(z),(y),(x)))*W_ave_f_d2(0,(z),(y),(x));\
F_bar_f_d2(1,(z),(y),(x))=W_ave_f_d2(1,(z),(y),(x))*F_bar_f_d2(0,(z),(y),(x));\
F_bar_f_d2(2,(z),(y),(x))=W_ave_f_d2(2,(z),(y),(x))*F_bar_f_d2(0,(z),(y),(x));\
F_bar_f_d2(3,(z),(y),(x))=W_ave_f_d2(3,(z),(y),(x))*F_bar_f_d2(0,(z),(y),(x));\
F_bar_f_d2(1+1,(z),(y),(x))+=W_ave_f_d2(4,(z),(y),(x));\
F_bar_f_d2(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_ave_f_d2(1+1,(z),(y),(x)))*W_ave_f_d2(4,(z),(y),(x))+0.500000*F_bar_f_d2(0,(z),(y),(x))*((W_ave_f_d2(1,(z),(y),(x))*W_ave_f_d2(1,(z),(y),(x)))+(W_ave_f_d2(2,(z),(y),(x))*W_ave_f_d2(2,(z),(y),(x)))+(W_ave_f_d2(3,(z),(y),(x))*W_ave_f_d2(3,(z),(y),(x))));\
}
#undef s17
#define s17(c,z,y,x) W_f_d2((c),(z),(y),(x))=(1.166667*W_ave_f_d2((c),(z),(y),(x)))+((-0.041667)*W_ave_f_d2((c),(z),(y),(x)+1))+((-0.041667)*W_ave_f_d2((c),(z),(y),(x)-1))+((-0.041667)*W_ave_f_d2((c),(z)+1,(y),(x)))+((-0.041667)*W_ave_f_d2((c),(z)-1,(y),(x)))
#undef s18
#define s18(z,y,x) {\
F_ave_f_d2(0,(z),(y),(x))=(W_f_d2(1+1,(z),(y),(x)))*W_f_d2(0,(z),(y),(x));\
F_ave_f_d2(1,(z),(y),(x))=W_f_d2(1,(z),(y),(x))*F_ave_f_d2(0,(z),(y),(x));\
F_ave_f_d2(2,(z),(y),(x))=W_f_d2(2,(z),(y),(x))*F_ave_f_d2(0,(z),(y),(x));\
F_ave_f_d2(3,(z),(y),(x))=W_f_d2(3,(z),(y),(x))*F_ave_f_d2(0,(z),(y),(x));\
F_ave_f_d2(1+1,(z),(y),(x))+=W_f_d2(4,(z),(y),(x));\
F_ave_f_d2(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_f_d2(1+1,(z),(y),(x)))*W_f_d2(4,(z),(y),(x))+0.500000*F_ave_f_d2(0,(z),(y),(x))*((W_f_d2(1,(z),(y),(x))*W_f_d2(1,(z),(y),(x)))+(W_f_d2(2,(z),(y),(x))*W_f_d2(2,(z),(y),(x)))+(W_f_d2(3,(z),(y),(x))*W_f_d2(3,(z),(y),(x))));\
}
#undef s19
#define s19(c,z,y,x) F_bar_f_d2((c),(z),(y),(x))*=0.041667
#undef s20
#define s20(c,z,y,x) F_ave_f_d2((c),(z),(y),(x))+=((-0.166667)*F_bar_f_d2((c),(z),(y),(x)))+(0.041667*F_bar_f_d2((c),(z),(y),(x)+1))+(0.041667*F_bar_f_d2((c),(z),(y),(x)-1))+(0.041667*F_bar_f_d2((c),(z)+1,(y),(x)))+(0.041667*F_bar_f_d2((c),(z)-1,(y),(x)))
#undef s21
#define s21(c,z,y,x) rhs((c),(z),(y),(x))+=((-1.000000)*F_ave_f_d2((c),(z),(y),(x)))+(1.000000*F_ave_f_d2((c),(z),(y)+1,(x)))
#undef s22
#define s22(c,z,y,x) W_aveL_d3((c),(z),(y),(x))=(0.033333*W_ave((c),(z)-3,(y),(x)))+((-0.050000)*W_ave((c),(z)+1,(y),(x)))+((-0.216667)*W_ave((c),(z)-2,(y),(x)))+(0.450000*W_ave((c),(z),(y),(x)))+(0.783333*W_ave((c),(z)-1,(y),(x)))
#undef s23
#define s23(c,z,y,x) W_aveH_d3((c),(z),(y),(x))=((-0.050000)*W_ave((c),(z)-2,(y),(x)))+(0.033333*W_ave((c),(z)+2,(y),(x)))+(0.450000*W_ave((c),(z)-1,(y),(x)))+((-0.216667)*W_ave((c),(z)+1,(y),(x)))+(0.783333*W_ave((c),(z),(y),(x)))
#undef s24
#define s24(z,y,x) {\
W_ave_f_d3(0,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(0,(z),(y),(x))) : (W_aveH_d3(0,(z),(y),(x)));\
W_ave_f_d3(1,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(1,(z),(y),(x))) : (W_aveH_d3(1,(z),(y),(x)));\
W_ave_f_d3(2,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(2,(z),(y),(x))) : (W_aveH_d3(2,(z),(y),(x)));\
W_ave_f_d3(3,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(3,(z),(y),(x))) : (W_aveH_d3(3,(z),(y),(x)));\
W_ave_f_d3(4,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(4,(z),(y),(x))) : (W_aveH_d3(4,(z),(y),(x)));\
W_ave_f_d3(0,(z),(y),(x))+=(0.000000 < sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000) ? (((((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000+((((((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))*(W_aveL_d3(2+1,(z),(y),(x))-W_aveH_d3(2+1,(z),(y),(x))))*0.500000-W_ave_f_d3(4,(z),(y),(x))))/((sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000)))*sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000)))) : (0.000000);\
W_ave_f_d3(2+1,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) : (W_ave_f_d3(2+1,(z),(y),(x)));\
W_ave_f_d3(4,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000+((((((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))*(W_aveL_d3(2+1,(z),(y),(x))-W_aveH_d3(2+1,(z),(y),(x))))*0.500000) : (W_ave_f_d3(4,(z),(y),(x)));\
}
#undef s25
#define s25(z,y,x) {\
F_bar_f_d3(0,(z),(y),(x))=(W_ave_f_d3(2+1,(z),(y),(x)))*W_ave_f_d3(0,(z),(y),(x));\
F_bar_f_d3(1,(z),(y),(x))=W_ave_f_d3(1,(z),(y),(x))*F_bar_f_d3(0,(z),(y),(x));\
F_bar_f_d3(2,(z),(y),(x))=W_ave_f_d3(2,(z),(y),(x))*F_bar_f_d3(0,(z),(y),(x));\
F_bar_f_d3(3,(z),(y),(x))=W_ave_f_d3(3,(z),(y),(x))*F_bar_f_d3(0,(z),(y),(x));\
F_bar_f_d3(2+1,(z),(y),(x))+=W_ave_f_d3(4,(z),(y),(x));\
F_bar_f_d3(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_ave_f_d3(2+1,(z),(y),(x)))*W_ave_f_d3(4,(z),(y),(x))+0.500000*F_bar_f_d3(0,(z),(y),(x))*((W_ave_f_d3(1,(z),(y),(x))*W_ave_f_d3(1,(z),(y),(x)))+(W_ave_f_d3(2,(z),(y),(x))*W_ave_f_d3(2,(z),(y),(x)))+(W_ave_f_d3(3,(z),(y),(x))*W_ave_f_d3(3,(z),(y),(x))));\
}
#undef s26
#define s26(c,z,y,x) W_f_d3((c),(z),(y),(x))=(1.166667*W_ave_f_d3((c),(z),(y),(x)))+((-0.041667)*W_ave_f_d3((c),(z),(y),(x)+1))+((-0.041667)*W_ave_f_d3((c),(z),(y),(x)-1))+((-0.041667)*W_ave_f_d3((c),(z),(y)+1,(x)))+((-0.041667)*W_ave_f_d3((c),(z),(y)-1,(x)))
#undef s27
#define s27(z,y,x) {\
F_ave_f_d3(0,(z),(y),(x))=(W_f_d3(2+1,(z),(y),(x)))*W_f_d3(0,(z),(y),(x));\
F_ave_f_d3(1,(z),(y),(x))=W_f_d3(1,(z),(y),(x))*F_ave_f_d3(0,(z),(y),(x));\
F_ave_f_d3(2,(z),(y),(x))=W_f_d3(2,(z),(y),(x))*F_ave_f_d3(0,(z),(y),(x));\
F_ave_f_d3(3,(z),(y),(x))=W_f_d3(3,(z),(y),(x))*F_ave_f_d3(0,(z),(y),(x));\
F_ave_f_d3(2+1,(z),(y),(x))+=W_f_d3(4,(z),(y),(x));\
F_ave_f_d3(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_f_d3(2+1,(z),(y),(x)))*W_f_d3(4,(z),(y),(x))+0.500000*F_ave_f_d3(0,(z),(y),(x))*((W_f_d3(1,(z),(y),(x))*W_f_d3(1,(z),(y),(x)))+(W_f_d3(2,(z),(y),(x))*W_f_d3(2,(z),(y),(x)))+(W_f_d3(3,(z),(y),(x))*W_f_d3(3,(z),(y),(x))));\
}
#undef s28
#define s28(c,z,y,x) F_bar_f_d3((c),(z),(y),(x))*=0.041667
#undef s29
#define s29(c,z,y,x) F_ave_f_d3((c),(z),(y),(x))+=((-0.166667)*F_bar_f_d3((c),(z),(y),(x)))+(0.041667*F_bar_f_d3((c),(z),(y),(x)+1))+(0.041667*F_bar_f_d3((c),(z),(y),(x)-1))+(0.041667*F_bar_f_d3((c),(z),(y)+1,(x)))+(0.041667*F_bar_f_d3((c),(z),(y)-1,(x)))
#undef s30
#define s30(c,z,y,x) rhs((c),(z),(y),(x))+=((-1.000000)*F_ave_f_d3((c),(z),(y),(x)))+(1.000000*F_ave_f_d3((c),(z)+1,(y),(x)))
#undef s31
#define s31(c,z,y,x) rhs((c),(z),(y),(x))*=-1.000000

for(t2 = zmin-1; t2 <= floord(N+4,8); t2 += zinc) {
  for(t4 = ymin-1; t4 <= floord(N+4,8); t4 += yinc) {
    for(t6 = xmin-1; t6 <= floord(N+4,8); t6 += xinc) {
      for(t8 = max(8*t2,-4); t8 <= min(N+4,8*t2+7); t8++) {
        for(t10 = max(-4,8*t4); t10 <= min(8*t4+7,N+4); t10++) {
          if (N >= t8-3) {
          for(t12 = max(8*t6,-4); t12 <= min(8*t6+7,N+4); t12++) {
              if (N >= t10-3) {
                if (N >= t12-3) {
                  s0(t8,t10,t12);
                  if (t10 >= -2 && t8 >= -2 && t12 >= -2) {
                    for(t14 = 0; t14 <= C-1; t14++) {
                      s1(t14,t8-1,t10-1,t12-1);
                    }
                    s2(t8-1,t10-1,t12-1);
                  }
                }
                if (t8 >= -2 && t12 >= -2 && t10 >= -2) {
                  if (t12 <= 1) {
                    if (t8 <= 1) {
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s3(t14,t8-1,t10-1,t12-1);
                      }
                    }
                    else {
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s3(t14,t8-1,t10-1,t12-1);
                        s22(t14,t8-2,t10-1,t12-1);
                        s23(t14,t8-3,t10-1,t12-1);
                      }
                    }
                  }
                  else {
                    if (N >= t12-3) {
                      if (t8 <= 1) {
                        for(t14 = 0; t14 <= C-1; t14++) {
                          s3(t14,t8-1,t10-1,t12-1);
                          s4(t14,t8-1,t10-1,t12-2);
                          s5(t14,t8-1,t10-1,t12-3);
                        }
                      }
                      else {
                        for(t14 = 0; t14 <= C-1; t14++) {
                          s3(t14,t8-1,t10-1,t12-1);
                          s4(t14,t8-1,t10-1,t12-2);
                          s5(t14,t8-1,t10-1,t12-3);
                          s22(t14,t8-2,t10-1,t12-1);
                          s23(t14,t8-3,t10-1,t12-1);
                        }
                      }
                    }
                  }
                  if (N >= t12-3) {
                    if (t12 >= 3) {
                      s6(t8-1,t10-1,t12-3);
                      s7(t8-1,t10-1,t12-3);
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s10(t14,t8-1,t10-1,t12-3);
                      }
                    }
                    if (t10 >= 2) {
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s13(t14,t8-1,t10-2,t12-1);
                      }
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s14(t14,t8-1,t10-3,t12-1);
                      }
                      if (t10 >= 3) {
                        s15(t8-1,t10-3,t12-1);
                        s16(t8-1,t10-3,t12-1);
                        for(t14 = 0; t14 <= C-1; t14++) {
                          s19(t14,t8-1,t10-3,t12-1);
                        }
                      }
                    }
                    if (t8 >= 3) {
                      s24(t8-3,t10-1,t12-1);
                      s25(t8-3,t10-1,t12-1);
                      if (t12 >= 0 && t10 >= 0) {
                        for(t14 = 0; t14 <= C-1; t14++) {
                          s26(t14,t8-3,t10-2,t12-2);
                        }
                        s27(t8-3,t10-2,t12-2);
                      }
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s28(t14,t8-3,t10-1,t12-1);
                      }
                    }
                  }
                }
              }
              if (t12 >= 1 && t10 >= 1 && t8 >= 3) {
                for(t14 = 0; t14 <= C-1; t14++) {
                  s29(t14,t8-3,t10-3,t12-3);
                }
              }
            }
            if (t8 >= 0 && t10 >= 0 && N >= t10-3) {
          for(t12 = max(3,8*t6); t12 <= min(N+3,8*t6+7); t12++) {
                for(t14 = 0; t14 <= C-1; t14++) {
                  s8(t14,t8-2,t10-2,t12-3);
                }
                s9(t8-2,t10-2,t12-3);
              }
            }
          }
          if (t10 >= 1) {
            if (t8 >= 1) {
          for(t12 = max(3,8*t6); t12 <= min(N+3,8*t6+7); t12++) {
                if (N >= t10-2) {
                  if (t12 <= 3) {
                    if (N >= t8-2) {
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s11(t14,t8-3,t10-3,t12-3);
                      }
                    }
                  }
                  else {
                    if (t8 <= 2) {
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s11(t14,t8-3,t10-3,t12-3);
                      }
                    }
                    else {
                      if (N >= t8-2) {
                        if (t10 <= 2) {
                          for(t14 = 0; t14 <= C-1; t14++) {
                            s11(t14,t8-3,t10-3,t12-3);
                          }
                        }
                        else {
                          for(t14 = 0; t14 <= C-1; t14++) {
                            s11(t14,t8-3,t10-3,t12-3);
                            s12(t14,t8-3,t10-3,t12-4);
                          }
                        }
                      }
                    }
                  }
                  if (t8 >= N+3) {
                    for(t14 = 0; t14 <= C-1; t14++) {
                      s11(t14,t8-3,t10-3,t12-3);
                    }
                  }
                }
                else {
                  for(t14 = 0; t14 <= C-1; t14++) {
                    s11(t14,t8-3,t10-3,t12-3);
                  }
                }
              }
            }
            if (t10 >= 3 && t8 >= 0 && N >= t10-3) {
              if (N >= t8-3) {
          for(t12 = max(0,8*t6); t12 <= min(N+3,8*t6+7); t12++) {
                  for(t14 = 0; t14 <= C-1; t14++) {
                    s17(t14,t8-2,t10-3,t12-2);
                  }
                  s18(t8-2,t10-3,t12-2);
                }
              }
              if (t8 >= 1) {
          for(t12 = max(1,8*t6); t12 <= min(N+4,8*t6+7); t12++) {
                  for(t14 = 0; t14 <= C-1; t14++) {
                    s20(t14,t8-3,t10-3,t12-3);
                  }
                  if (t12 >= 4 && t10 >= 4 && N >= t12-3 && t8 >= 3) {
                    if (N >= t8-2) {
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s21(t14,t8-3,t10-4,t12-4);
                      }
                    }
                    if (t8 >= 4 && N >= t8-3) {
                      for(t14 = 0; t14 <= C-1; t14++) {
                        s30(t14,t8-4,t10-4,t12-4);
                        s31(t14,t8-4,t10-4,t12-4);
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

}    // euler_step

double euler_step(const double* U, double* rhs);
inline double euler_step(const double* U, double* rhs) {
    double* __restrict__ d_U = (double*) cuda_malloc(1866240 * sizeof(double));
    double* __restrict__ d_rhs = (double*) cuda_malloc(1310720 * sizeof(double));

    euler_step_params* params = (euler_step_params*) malloc(sizeof(euler_step_params));
    euler_step_params* d_params = (euler_step_params*) cuda_malloc(sizeof(euler_step_params));
    params->array0 = (double*) cuda_malloc(1866240 * sizeof(double));
    params->array1 = (double*) cuda_malloc(5 * sizeof(double));
    params->array2 = (double*) cuda_malloc(5 * sizeof(double));
    params->array3 = (double*) cuda_malloc(1715000 * sizeof(double));
    params->array4 = (double*) cuda_malloc(1617000 * sizeof(double));
    params->array5 = (double*) cuda_malloc(1617000 * sizeof(double));
    params->array6 = (double*) cuda_malloc(1592500 * sizeof(double));
    params->array7 = (double*) cuda_malloc(1592500 * sizeof(double));
    params->array8 = (double*) cuda_malloc(5 * sizeof(double));
    params->array9 = (double*) cuda_malloc(1502800 * sizeof(double));
    params->array10 = (double*) cuda_malloc(5 * sizeof(double));
    params->array11 = (double*) cuda_malloc(5 * sizeof(double));
    params->array12 = (double*) cuda_malloc(1592500 * sizeof(double));
    params->array13 = (double*) cuda_malloc(1592500 * sizeof(double));
    params->array14 = (double*) cuda_malloc(5 * sizeof(double));
    params->array15 = (double*) cuda_malloc(1502800 * sizeof(double));
    params->array16 = (double*) cuda_malloc(5 * sizeof(double));
    params->array17 = (double*) cuda_malloc(5 * sizeof(double));
    params->array18 = (double*) cuda_malloc(1592500 * sizeof(double));
    params->array19 = (double*) cuda_malloc(1592500 * sizeof(double));
    params->array20 = (double*) cuda_malloc(5 * sizeof(double));
    params->array21 = (double*) cuda_malloc(1502800 * sizeof(double));

    // TODO: How to determine block sizes?
    unsigned blk_size = 1; //8;
    unsigned grid_size = 1; //(N+2*G) / blk_size;
    fprintf(stderr, "blk_size=%u, grid_size=%u\n", blk_size, grid_size);
    dim3 blk_dim(blk_size, blk_size, blk_size); //16, 32, 64);
    dim3 grid_dim(grid_size, grid_size, grid_size);

    // Copy host to device
    cuda_copy_device(U, d_U, 1866240 * sizeof(double));
    cuda_copy_device(params, d_params, sizeof(euler_step_params));

    euler_step_<<<blk_dim, grid_dim>>>(d_U, d_rhs, d_params);
    gpuCheck("euler_step");

    // Copy device to host
    cuda_copy_host(d_rhs, rhs, 1310720 * sizeof(double));

    cuda_free(d_U);
    cuda_free(d_rhs);

    cuda_free(params->array0);
    cuda_free(params->array1);
    cuda_free(params->array2);
    cuda_free(params->array3);
    cuda_free(params->array4);
    cuda_free(params->array5);
    cuda_free(params->array6);
    cuda_free(params->array7);
    cuda_free(params->array8);
    cuda_free(params->array9);
    cuda_free(params->array10);
    cuda_free(params->array11);
    cuda_free(params->array12);
    cuda_free(params->array13);
    cuda_free(params->array14);
    cuda_free(params->array15);
    cuda_free(params->array16);
    cuda_free(params->array17);
    cuda_free(params->array18);
    cuda_free(params->array19);
    cuda_free(params->array20);
    cuda_free(params->array21);
    cuda_free(d_params);
    free(params);

    return (0);
}

#undef min
#undef max
#undef abs
#undef absmin
#undef absmax
#undef floord
#undef sgn
#undef offset2
#undef offset3
#undef offset4
#undef arrinit
#undef arrprnt
#undef tid
#undef C
#undef D
#undef G
#undef N
#undef T
#undef U
#undef W_bar
#undef u
#undef W
#undef W_ave
#undef W_aveL_d1
#undef W_aveH_d1
#undef W_ave_f_d1
#undef F_bar_f_d1
#undef W_f_d1
#undef F_ave_f_d1
#undef rhs
#undef W_aveL_d2
#undef W_aveH_d2
#undef W_ave_f_d2
#undef F_bar_f_d2
#undef W_f_d2
#undef F_ave_f_d2
#undef W_aveL_d3
#undef W_aveH_d3
#undef W_ave_f_d3
#undef F_bar_f_d3
#undef W_f_d3
#undef F_ave_f_d3

