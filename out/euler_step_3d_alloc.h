// 'euler_step' code generated by 'edavis' at 07/19/2019 16:55:17
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <math.h>
#include <string.h>

#define min(x,y) (((x)<(y))?(x):(y))
#define max(x,y) (((x)>(y))?(x):(y))
#define abs(x) ((x)<0?-(x):(x))
#define absmin(x,y) ((x)=min(abs((x)),abs((y))))
#define absmax(x,y) ((x)=max(abs((x)),abs((y))))
#define floord(x,y) ((x)/(y))
#define sgn(x) ((x)<0?-1:1)
#define offset2(i,j,M) ((j)+(i)*(M))
#define offset3(i,j,k,M,N) ((k)+((j)+(i)*(M))*(N))
#define offset4(i,j,k,l,M,N,P) ((l)+((k)+((j)+(i)*(M))*(N))*(P))
#define arrinit(ptr,val,size) for(unsigned __i__=0;__i__<(size);__i__++) (ptr)[__i__]=(val)
#define arrprnt(name,arr,size) {\
fprintf(stderr,"%s={",(name));\
for(unsigned __i__=0;__i__<(size);__i__++) fprintf(stderr,"%lg,",(arr)[__i__]);\
fprintf(stderr,"}\n");}

#define C 5
#define D 3
#define G 4
#define N 64

#define U(c,z,y,x) U[offset4((c),(z)+4,(y)+4,(x)+4,(N+3+4+1),(N+3+4+1),(N+3+4+1))]
#define W_bar(c,z,y,x) array3[offset4((c),(z)+4,(y)+4,(x)+4,(N+3+4+1),(N+3+4+1),(N+3+4+1))]
#define u(c,z,y,x) array5[(c)]
#define W(c,z,y,x) array4[offset4((c),(z)+3,(y)+3,(x)+3,(N+2+3+1),(N+2+3+1),(N+2+3+1))]
#define umax(z,y,x) scalar0
#define W_ave(c,z,y,x) array1[offset3((z)+3,(y)+3,(x)+3,(N+2+3+1),(N+2+3+1))]
#define W_aveL_d1(c,z,y,x) array11[offset4((c),(z)+3,(y)+3,(x),(N+2+3+1),(N+2+3+1),(N+1+1))]
#define W_aveH_d1(c,z,y,x) array10[offset4((c),(z)+3,(y)+3,(x)+1,(N+2+3+1),(N+2+3+1),(N+1+1))]
#define W_aveL_d2(c,z,y,x) array9[offset4((c),(z)+3,(y),(x)+3,(N+2+3+1),(N+1+1),(N+2+3+1))]
#define W_aveH_d2(c,z,y,x) array8[offset4((c),(z)+3,(y)+1,(x)+3,(N+2+3+1),(N+1+1),(N+2+3+1))]
#define W_aveL_d3(c,z,y,x) array7[offset4((c),(z),(y)+3,(x)+3,(N+1+1),(N+2+3+1),(N+2+3+1))]
#define W_aveH_d3(c,z,y,x) array6[offset4((c),(z)+1,(y)+3,(x)+3,(N+1+1),(N+2+3+1),(N+2+3+1))]
#define W_ave_f_d1(c,z,y,x) array4[offset4((c),(z)+3,(y)+3,(x),(N+2+3+1),(N+2+3+1),(N+1))]
#define F_bar_f_d1(c,z,y,x) array3[offset4((c),(z)+3,(y)+3,(x),(N+2+3+1),(N+2+3+1),(N+1))]
#define W_f_d1(c,z,y,x) array5[(c)]
#define F_ave_f_d1(c,z,y,x) array1[offset4((c),(z)+2,(y)+2,(x),(N+1+2+1),(N+1+2+1),(N+1))]
#define F_lap_f_d1(c,z,y,x) scalar0
#define F_div_f_d1(c,z,y,x) scalar2
#define rhs(c,z,y,x) rhs[offset4((c),(z),(y),(x),(N-1+1),(N-1+1),(N-1+1))]
#define W_ave_f_d2(c,z,y,x) array4[offset4((c),(z)+3,(y),(x)+3,(N+2+3+1),(N+1),(N+2+3+1))]
#define F_bar_f_d2(c,z,y,x) array3[offset4((c),(z)+3,(y),(x)+3,(N+2+3+1),(N+1),(N+2+3+1))]
#define W_f_d2(c,z,y,x) array5[(c)]
#define F_ave_f_d2(c,z,y,x) array1[offset4((c),(z)+2,(y),(x)+2,(N+1+2+1),(N+1),(N+1+2+1))]
#define F_lap_f_d2(c,z,y,x) scalar0
#define F_div_f_d2(c,z,y,x) scalar2
#define W_ave_f_d3(c,z,y,x) array4[(c)]
#define F_bar_f_d3(c,z,y,x) array3[offset4((c),(z),(y)+3,(x)+3,(N+1),(N+2+3+1),(N+2+3+1))]
#define W_f_d3(c,z,y,x) array5[(c)]
#define F_ave_f_d3(c,z,y,x) array1[offset4((c),(z),(y)+2,(x)+2,(N+1),(N+1+2+1),(N+1+2+1))]
#define F_lap_f_d3(c,z,y,x) scalar0
#define F_div_f_d3(c,z,y,x) scalar2

double euler_step(const double* U, double* rhs);
inline double euler_step(const double* U, double* rhs) {
    int t1,t2,t3,t4,t5,t6,t7,t8,t9,t10,t11,t12,t13,t14,t15;

    double retval;          // Return values remain the same...
    double scalar0;
    double* array1 = (double*) malloc(1502800*sizeof(double));
    double scalar2;
    double* array3 = (double*) malloc(1866240*sizeof(double));
    double* array4 = (double*) malloc(1715000*sizeof(double));
    double* array5 = (double*) malloc(5*sizeof(double));
    double* array6 = (double*) malloc(1617000*sizeof(double));
    double* array7 = (double*) malloc(1617000*sizeof(double));
    double* array8 = (double*) malloc(1617000*sizeof(double));
    double* array9 = (double*) malloc(1617000*sizeof(double));
    double* array10 = (double*) malloc(1617000*sizeof(double));
    double* array11 = (double*) malloc(1617000*sizeof(double));

// consToPrim1+deconvolve+consToPrim2+waveSpeedBound1+absMax
#undef s0
#define s0(z,y,x) {\
W_bar(0,(z),(y),(x)) = U(0,(z),(y),(x));\
W_bar(1,(z),(y),(x)) = U(1,(z),(y),(x))/U(0,(z),(y),(x));\
W_bar(2,(z),(y),(x)) = U(2,(z),(y),(x))/U(0,(z),(y),(x));\
W_bar(3,(z),(y),(x)) = U(3,(z),(y),(x))/U(0,(z),(y),(x));\
W_bar(4,(z),(y),(x)) = (U(4,(z),(y),(x))-0.500000*U(0,(z),(y),(x))*(((U(1,(z),(y),(x))/U(0,(z),(y),(x)))*(U(1,(z),(y),(x))/U(0,(z),(y),(x))))+((U(2,(z),(y),(x))/U(0,(z),(y),(x)))*(U(2,(z),(y),(x))/U(0,(z),(y),(x))))+((U(3,(z),(y),(x))/U(0,(z),(y),(x)))*(U(3,(z),(y),(x))/U(0,(z),(y),(x))))))*(1.400000-1.000000);\
}
#undef s1
#define s1(c,z,y,x) u((c),(z),(y),(x))=(1.250000*U((c),(z),(y),(x)))+((-0.041667)*U((c),(z),(y),(x)+1))+((-0.041667)*U((c),(z),(y),(x)-1))+((-0.041667)*U((c),(z),(y)+1,(x)))+((-0.041667)*U((c),(z),(y)-1,(x)))+((-0.041667)*U((c),(z)+1,(y),(x)))+((-0.041667)*U((c),(z)-1,(y),(x)))
#undef s2
#define s2(z,y,x) {\
W(0,(z),(y),(x)) = u(0,(z),(y),(x));\
W(1,(z),(y),(x)) = u(1,(z),(y),(x))/u(0,(z),(y),(x));\
W(2,(z),(y),(x)) = u(2,(z),(y),(x))/u(0,(z),(y),(x));\
W(3,(z),(y),(x)) = u(3,(z),(y),(x))/u(0,(z),(y),(x));\
W(4,(z),(y),(x)) = (u(4,(z),(y),(x))-0.500000*u(0,(z),(y),(x))*(((u(1,(z),(y),(x))/u(0,(z),(y),(x)))*(u(1,(z),(y),(x))/u(0,(z),(y),(x))))+((u(2,(z),(y),(x))/u(0,(z),(y),(x)))*(u(2,(z),(y),(x))/u(0,(z),(y),(x))))+((u(3,(z),(y),(x))/u(0,(z),(y),(x)))*(u(3,(z),(y),(x))/u(0,(z),(y),(x))))))*(1.400000-1.000000);\
}
#undef s3
#define s3(z,y,x) {\
umax((z),(y),(x))=(3.000000*sqrt(1.400000*W(4,(z),(y),(x))/W(0,(z),(y),(x))))+W(1,(z),(y),(x))+W(2,(z),(y),(x))+W(3,(z),(y),(x));\
}
#undef s4
#define s4(z,y,x) absmax(retval,umax((z),(y),(x)))

//#pragma omp parallel for schedule(auto) private(t2,t4,t6,t8)
for(t2 = -4; t2 <= N+3; t2++) {
  for(t4 = -4; t4 <= N+3; t4++) {
    #pragma omp simd
    for(t6 = -4; t6 <= N+3; t6++) {
      s0(t2,t4,t6);
      if (t6 >= -3 && t4 >= -3 && N >= t2-2 && N >= t6-2 && N >= t4-2 && t2 >= -3) {
        s1(0,t2,t4,t6);
        s1(1,t2,t4,t6);
        s1(2,t2,t4,t6);
        s1(3,t2,t4,t6);
        s1(4,t2,t4,t6);
        s2(t2,t4,t6);
        if (t6 >= 0 && t2 >= 0 && N >= t4+1 && N >= t6+1 && N >= t2+1 && t4 >= 0) {
          s3(t2,t4,t6);
          s4(t2,t4,t6);
        }
      }
    }
  }
}

// laplacian+increment+interpL_d1+interpH_d1+interpL_d2+interpH_d2+interpL_d3+interpH_d3
#undef s0
#define s0(c,z,y,x) W_ave((c),(z),(y),(x))=((-0.250000)*W_bar((c),(z),(y),(x)))+(0.041667*W_bar((c),(z),(y),(x)+1))+(0.041667*W_bar((c),(z),(y),(x)-1))+(0.041667*W_bar((c),(z),(y)+1,(x)))+(0.041667*W_bar((c),(z),(y)-1,(x)))+(0.041667*W_bar((c),(z)+1,(y),(x)))+(0.041667*W_bar((c),(z)-1,(y),(x)))
#undef s1
#define s1(c,z,y,x) W_ave((c),(z),(y),(x))+=W((c),(z),(y),(x))
#undef s2
#define s2(c,z,y,x) W_aveL_d1((c),(z),(y),(x))=(0.033333*W_ave((c),(z),(y),(x)-3))+((-0.050000)*W_ave((c),(z),(y),(x)+1))+((-0.216667)*W_ave((c),(z),(y),(x)-2))+(0.450000*W_ave((c),(z),(y),(x)))+(0.783333*W_ave((c),(z),(y),(x)-1))
#undef s3
#define s3(c,z,y,x) W_aveH_d1((c),(z),(y),(x))=((-0.050000)*W_ave((c),(z),(y),(x)-2))+(0.033333*W_ave((c),(z),(y),(x)+2))+(0.450000*W_ave((c),(z),(y),(x)-1))+((-0.216667)*W_ave((c),(z),(y),(x)+1))+(0.783333*W_ave((c),(z),(y),(x)))
#undef s4
#define s4(c,z,y,x) W_aveL_d2((c),(z),(y),(x))=(0.033333*W_ave((c),(z),(y)-3,(x)))+((-0.050000)*W_ave((c),(z),(y)+1,(x)))+((-0.216667)*W_ave((c),(z),(y)-2,(x)))+(0.450000*W_ave((c),(z),(y),(x)))+(0.783333*W_ave((c),(z),(y)-1,(x)))
#undef s5
#define s5(c,z,y,x) W_aveH_d2((c),(z),(y),(x))=((-0.050000)*W_ave((c),(z),(y)-2,(x)))+(0.033333*W_ave((c),(z),(y)+2,(x)))+(0.450000*W_ave((c),(z),(y)-1,(x)))+((-0.216667)*W_ave((c),(z),(y)+1,(x)))+(0.783333*W_ave((c),(z),(y),(x)))
#undef s6
#define s6(c,z,y,x) W_aveL_d3((c),(z),(y),(x))=(0.033333*W_ave((c),(z)-3,(y),(x)))+((-0.050000)*W_ave((c),(z)+1,(y),(x)))+((-0.216667)*W_ave((c),(z)-2,(y),(x)))+(0.450000*W_ave((c),(z),(y),(x)))+(0.783333*W_ave((c),(z)-1,(y),(x)))
#undef s7
#define s7(c,z,y,x) W_aveH_d3((c),(z),(y),(x))=((-0.050000)*W_ave((c),(z)-2,(y),(x)))+(0.033333*W_ave((c),(z)+2,(y),(x)))+(0.450000*W_ave((c),(z)-1,(y),(x)))+((-0.216667)*W_ave((c),(z)+1,(y),(x)))+(0.783333*W_ave((c),(z),(y),(x)))

//#pragma omp parallel for schedule(auto) private(t2,t4,t6,t8)
for(t2 = 0; t2 <= C-1; t2++) {
  for(t4 = -3; t4 <= N+2; t4++) {
    for(t6 = -3; t6 <= N+2; t6++) {
      if (t6 <= 0) {
        if (t4 <= 0) {
          #pragma omp simd
          for(t8 = -3; t8 <= 0; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
          }
        }
        else {
          #pragma omp simd
          for(t8 = -3; t8 <= 0; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s6(t2,t4-1,t6,t8);
            s7(t2,t4-2,t6,t8);
          }
        }
      }
      else {
        if (t4 <= 0) {
          #pragma omp simd
          for(t8 = -3; t8 <= 0; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s4(t2,t4,t6-1,t8);
            s5(t2,t4,t6-2,t8);
          }
        }
        else {
          #pragma omp simd
          for(t8 = -3; t8 <= 0; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s4(t2,t4,t6-1,t8);
            s5(t2,t4,t6-2,t8);
            s6(t2,t4-1,t6,t8);
            s7(t2,t4-2,t6,t8);
          }
        }
      }
      if (t6 <= 0) {
        if (t4 <= 0) {
          #pragma omp simd
          for(t8 = 1; t8 <= N+2; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s2(t2,t4,t6,t8-1);
            s3(t2,t4,t6,t8-2);
          }
        }
        else {
          #pragma omp simd
          for(t8 = 1; t8 <= N+2; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s2(t2,t4,t6,t8-1);
            s3(t2,t4,t6,t8-2);
            s6(t2,t4-1,t6,t8);
            s7(t2,t4-2,t6,t8);
          }
        }
      }
      else {
        if (t4 <= 0) {
          #pragma omp simd
          for(t8 = 1; t8 <= N+2; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s2(t2,t4,t6,t8-1);
            s3(t2,t4,t6,t8-2);
            s4(t2,t4,t6-1,t8);
            s5(t2,t4,t6-2,t8);
          }
        }
        else {
          #pragma omp simd
          for(t8 = 1; t8 <= N+2; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s2(t2,t4,t6,t8-1);
            s3(t2,t4,t6,t8-2);
            s4(t2,t4,t6-1,t8);
            s5(t2,t4,t6-2,t8);
            s6(t2,t4-1,t6,t8);
            s7(t2,t4-2,t6,t8);
          }
        }
      }
    }
  }
}

// upwindState1+getFlux1+deconvolve_f_d1+getFlux2+smul_d1
#undef s0
#define s0(z,y,x) {\
W_ave_f_d1(0,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(0,(z),(y),(x))) : (W_aveH_d1(0,(z),(y),(x)));\
W_ave_f_d1(1,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(1,(z),(y),(x))) : (W_aveH_d1(1,(z),(y),(x)));\
W_ave_f_d1(2,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(2,(z),(y),(x))) : (W_aveH_d1(2,(z),(y),(x)));\
W_ave_f_d1(3,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(3,(z),(y),(x))) : (W_aveH_d1(3,(z),(y),(x)));\
W_ave_f_d1(4,(z),(y),(x))=(0.000000 < ((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d1(4,(z),(y),(x))) : (W_aveH_d1(4,(z),(y),(x)));\
W_ave_f_d1(0,(z),(y),(x))+=(0.000000 < sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000) ? (((((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000+((((((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))*(W_aveL_d1(0+1,(z),(y),(x))-W_aveH_d1(0+1,(z),(y),(x))))*0.500000-W_ave_f_d1(4,(z),(y),(x))))/((sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000)))*sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000)))) : (0.000000);\
W_ave_f_d1(0+1,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))) : (W_ave_f_d1(0+1,(z),(y),(x)));\
W_ave_f_d1(4,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000+((W_aveL_d1(4,(z),(y),(x))-W_aveH_d1(4,(z),(y),(x))))/((2.000000*(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d1(0+1,(z),(y),(x))+W_aveH_d1(0+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000+((((((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d1(4,(z),(y),(x))+W_aveH_d1(4,(z),(y),(x))))*0.500000))/(((W_aveL_d1(0,(z),(y),(x))+W_aveH_d1(0,(z),(y),(x))))*0.500000))))*(W_aveL_d1(0+1,(z),(y),(x))-W_aveH_d1(0+1,(z),(y),(x))))*0.500000) : (W_ave_f_d1(4,(z),(y),(x)));\
}
#undef s1
#define s1(z,y,x) {\
F_bar_f_d1(0,(z),(y),(x))=(W_ave_f_d1(0+1,(z),(y),(x)))*W_ave_f_d1(0,(z),(y),(x));\
F_bar_f_d1(1,(z),(y),(x))=W_ave_f_d1(1,(z),(y),(x))*F_bar_f_d1(0,(z),(y),(x));\
F_bar_f_d1(2,(z),(y),(x))=W_ave_f_d1(2,(z),(y),(x))*F_bar_f_d1(0,(z),(y),(x));\
F_bar_f_d1(3,(z),(y),(x))=W_ave_f_d1(3,(z),(y),(x))*F_bar_f_d1(0,(z),(y),(x));\
F_bar_f_d1(0+1,(z),(y),(x))+=W_ave_f_d1(4,(z),(y),(x));\
F_bar_f_d1(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_ave_f_d1(0+1,(z),(y),(x)))*W_ave_f_d1(4,(z),(y),(x))+0.500000*F_bar_f_d1(0,(z),(y),(x))*((W_ave_f_d1(1,(z),(y),(x))*W_ave_f_d1(1,(z),(y),(x)))+(W_ave_f_d1(2,(z),(y),(x))*W_ave_f_d1(2,(z),(y),(x)))+(W_ave_f_d1(3,(z),(y),(x))*W_ave_f_d1(3,(z),(y),(x))));\
}
#undef s2
#define s2(c,z,y,x) W_f_d1((c),(z),(y),(x))=(1.166667*W_ave_f_d1((c),(z),(y),(x)))+((-0.041667)*W_ave_f_d1((c),(z),(y)+1,(x)))+((-0.041667)*W_ave_f_d1((c),(z),(y)-1,(x)))+((-0.041667)*W_ave_f_d1((c),(z)+1,(y),(x)))+((-0.041667)*W_ave_f_d1((c),(z)-1,(y),(x)))
#undef s3
#define s3(z,y,x) {\
F_ave_f_d1(0,(z),(y),(x))=(W_f_d1(0+1,(z),(y),(x)))*W_f_d1(0,(z),(y),(x));\
F_ave_f_d1(1,(z),(y),(x))=W_f_d1(1,(z),(y),(x))*F_ave_f_d1(0,(z),(y),(x));\
F_ave_f_d1(2,(z),(y),(x))=W_f_d1(2,(z),(y),(x))*F_ave_f_d1(0,(z),(y),(x));\
F_ave_f_d1(3,(z),(y),(x))=W_f_d1(3,(z),(y),(x))*F_ave_f_d1(0,(z),(y),(x));\
F_ave_f_d1(0+1,(z),(y),(x))+=W_f_d1(4,(z),(y),(x));\
F_ave_f_d1(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_f_d1(0+1,(z),(y),(x)))*W_f_d1(4,(z),(y),(x))+0.500000*F_ave_f_d1(0,(z),(y),(x))*((W_f_d1(1,(z),(y),(x))*W_f_d1(1,(z),(y),(x)))+(W_f_d1(2,(z),(y),(x))*W_f_d1(2,(z),(y),(x)))+(W_f_d1(3,(z),(y),(x))*W_f_d1(3,(z),(y),(x))));\
}
#undef s4
#define s4(c,z,y,x) F_bar_f_d1((c),(z),(y),(x))*=0.041667

//#pragma omp parallel for schedule(auto) private(t2,t4,t6,t8)
for(t2 = -3; t2 <= N+2; t2++) {
  for(t4 = -3; t4 <= N+2; t4++) {
    #pragma omp simd
    for(t6 = 0; t6 <= N; t6++) {
      s0(t2,t4,t6);
      s1(t2,t4,t6);
      if (t2 <= -2) {
          s4(0,t2,t4,t6);
          s4(1,t2,t4,t6);
          s4(2,t2,t4,t6);
          s4(3,t2,t4,t6);
          s4(4,t2,t4,t6);
      }
      else {
        if (t4 <= -2) {
            s4(0,t2,t4,t6);
            s4(1,t2,t4,t6);
            s4(2,t2,t4,t6);
            s4(3,t2,t4,t6);
            s4(4,t2,t4,t6);
        }
        else {
            s2(0,t2-1,t4-1,t6);
            s2(1,t2-1,t4-1,t6);
            s2(2,t2-1,t4-1,t6);
            s2(3,t2-1,t4-1,t6);
            s2(4,t2-1,t4-1,t6);
            s4(0,t2,t4,t6);
            s4(1,t2,t4,t6);
            s4(2,t2,t4,t6);
            s4(3,t2,t4,t6);
            s4(4,t2,t4,t6);
        }
      }
      if (t2 >= -1 && t4 >= -1) {
        s3(t2-1,t4-1,t6);
      }
    }
  }
}

// lap_f_d1+inc_f_d1+div_f_d1+inc_rhs_d1
#undef s0
#define s0(c,z,y,x) F_lap_f_d1((c),(z),(y),(x))=((-0.166667)*F_bar_f_d1((c),(z),(y),(x)))+(0.041667*F_bar_f_d1((c),(z),(y)+1,(x)))+(0.041667*F_bar_f_d1((c),(z),(y)-1,(x)))+(0.041667*F_bar_f_d1((c),(z)+1,(y),(x)))+(0.041667*F_bar_f_d1((c),(z)-1,(y),(x)))
#undef s1
#define s1(c,z,y,x) F_ave_f_d1((c),(z),(y),(x))+=F_lap_f_d1((c),(z),(y),(x))
#undef s2
#define s2(c,z,y,x) F_div_f_d1((c),(z),(y),(x))=((-1.000000)*F_ave_f_d1((c),(z),(y),(x)))+(1.000000*F_ave_f_d1((c),(z),(y),(x)+1))
#undef s3
#define s3(c,z,y,x) rhs((c),(z),(y),(x))+=F_div_f_d1((c),(z),(y),(x))

//#pragma omp parallel for schedule(auto) private(t2,t4,t6,t8)
for(t2 = 0; t2 <= C-1; t2++) {
  for(t4 = -2; t4 <= N+1; t4++) {
    #pragma omp simd
    for(t6 = -2; t6 <= N+1; t6++) {
      s0(t2,t4,t6,0);
      s1(t2,t4,t6,0);
      if (t4 <= -1) {
        for(t8 = 1; t8 <= N; t8++) {
          s0(t2,t4,t6,t8);
          s1(t2,t4,t6,t8);
          s2(t2,t4,t6,t8-1);
        }
      }
      else {
        if (N >= t4+1) {
          if (t6 <= -1) {
            for(t8 = 1; t8 <= N; t8++) {
              s0(t2,t4,t6,t8);
              s1(t2,t4,t6,t8);
              s2(t2,t4,t6,t8-1);
            }
          }
          else {
            if (N >= t6+1) {
              for(t8 = 1; t8 <= N; t8++) {
                s0(t2,t4,t6,t8);
                s1(t2,t4,t6,t8);
                s2(t2,t4,t6,t8-1);
                s3(t2,t4,t6,t8-1);
              }
            }
            else {
              for(t8 = 1; t8 <= N; t8++) {
                s0(t2,t4,t6,t8);
                s1(t2,t4,t6,t8);
                s2(t2,t4,t6,t8-1);
              }
            }
          }
        }
      }
      if (t4 >= N) {
        for(t8 = 1; t8 <= N; t8++) {
          s0(t2,t4,t6,t8);
          s1(t2,t4,t6,t8);
          s2(t2,t4,t6,t8-1);
        }
      }
    }
  }
}

// upwindState2+getFlux3+deconvolve_f_d2+getFlux4+smul_d2
#undef s0
#define s0(z,y,x) {\
W_ave_f_d2(0,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(0,(z),(y),(x))) : (W_aveH_d2(0,(z),(y),(x)));\
W_ave_f_d2(1,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(1,(z),(y),(x))) : (W_aveH_d2(1,(z),(y),(x)));\
W_ave_f_d2(2,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(2,(z),(y),(x))) : (W_aveH_d2(2,(z),(y),(x)));\
W_ave_f_d2(3,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(3,(z),(y),(x))) : (W_aveH_d2(3,(z),(y),(x)));\
W_ave_f_d2(4,(z),(y),(x))=(0.000000 < ((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d2(4,(z),(y),(x))) : (W_aveH_d2(4,(z),(y),(x)));\
W_ave_f_d2(0,(z),(y),(x))+=(0.000000 < sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000) ? (((((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000+((((((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))*(W_aveL_d2(1+1,(z),(y),(x))-W_aveH_d2(1+1,(z),(y),(x))))*0.500000-W_ave_f_d2(4,(z),(y),(x))))/((sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000)))*sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000)))) : (0.000000);\
W_ave_f_d2(1+1,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))) : (W_ave_f_d2(1+1,(z),(y),(x)));\
W_ave_f_d2(4,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000+((W_aveL_d2(4,(z),(y),(x))-W_aveH_d2(4,(z),(y),(x))))/((2.000000*(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d2(1+1,(z),(y),(x))+W_aveH_d2(1+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000+((((((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d2(4,(z),(y),(x))+W_aveH_d2(4,(z),(y),(x))))*0.500000))/(((W_aveL_d2(0,(z),(y),(x))+W_aveH_d2(0,(z),(y),(x))))*0.500000))))*(W_aveL_d2(1+1,(z),(y),(x))-W_aveH_d2(1+1,(z),(y),(x))))*0.500000) : (W_ave_f_d2(4,(z),(y),(x)));\
}
#undef s1
#define s1(z,y,x) {\
F_bar_f_d2(0,(z),(y),(x))=(W_ave_f_d2(1+1,(z),(y),(x)))*W_ave_f_d2(0,(z),(y),(x));\
F_bar_f_d2(1,(z),(y),(x))=W_ave_f_d2(1,(z),(y),(x))*F_bar_f_d2(0,(z),(y),(x));\
F_bar_f_d2(2,(z),(y),(x))=W_ave_f_d2(2,(z),(y),(x))*F_bar_f_d2(0,(z),(y),(x));\
F_bar_f_d2(3,(z),(y),(x))=W_ave_f_d2(3,(z),(y),(x))*F_bar_f_d2(0,(z),(y),(x));\
F_bar_f_d2(1+1,(z),(y),(x))+=W_ave_f_d2(4,(z),(y),(x));\
F_bar_f_d2(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_ave_f_d2(1+1,(z),(y),(x)))*W_ave_f_d2(4,(z),(y),(x))+0.500000*F_bar_f_d2(0,(z),(y),(x))*((W_ave_f_d2(1,(z),(y),(x))*W_ave_f_d2(1,(z),(y),(x)))+(W_ave_f_d2(2,(z),(y),(x))*W_ave_f_d2(2,(z),(y),(x)))+(W_ave_f_d2(3,(z),(y),(x))*W_ave_f_d2(3,(z),(y),(x))));\
}
#undef s2
#define s2(c,z,y,x) W_f_d2((c),(z),(y),(x))=(1.166667*W_ave_f_d2((c),(z),(y),(x)))+((-0.041667)*W_ave_f_d2((c),(z),(y),(x)+1))+((-0.041667)*W_ave_f_d2((c),(z),(y),(x)-1))+((-0.041667)*W_ave_f_d2((c),(z)+1,(y),(x)))+((-0.041667)*W_ave_f_d2((c),(z)-1,(y),(x)))
#undef s3
#define s3(z,y,x) {\
F_ave_f_d2(0,(z),(y),(x))=(W_f_d2(1+1,(z),(y),(x)))*W_f_d2(0,(z),(y),(x));\
F_ave_f_d2(1,(z),(y),(x))=W_f_d2(1,(z),(y),(x))*F_ave_f_d2(0,(z),(y),(x));\
F_ave_f_d2(2,(z),(y),(x))=W_f_d2(2,(z),(y),(x))*F_ave_f_d2(0,(z),(y),(x));\
F_ave_f_d2(3,(z),(y),(x))=W_f_d2(3,(z),(y),(x))*F_ave_f_d2(0,(z),(y),(x));\
F_ave_f_d2(1+1,(z),(y),(x))+=W_f_d2(4,(z),(y),(x));\
F_ave_f_d2(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_f_d2(1+1,(z),(y),(x)))*W_f_d2(4,(z),(y),(x))+0.500000*F_ave_f_d2(0,(z),(y),(x))*((W_f_d2(1,(z),(y),(x))*W_f_d2(1,(z),(y),(x)))+(W_f_d2(2,(z),(y),(x))*W_f_d2(2,(z),(y),(x)))+(W_f_d2(3,(z),(y),(x))*W_f_d2(3,(z),(y),(x))));\
}
#undef s4
#define s4(c,z,y,x) F_bar_f_d2((c),(z),(y),(x))*=0.041667

//#pragma omp parallel for schedule(auto) private(t2,t4,t6,t8)
for(t2 = -3; t2 <= N+2; t2++) {
  for(t4 = 0; t4 <= N; t4++) {
    #pragma omp simd
    for(t6 = -3; t6 <= N+2; t6++) {
      s0(t2,t4,t6);
      s1(t2,t4,t6);
      if (t2 <= -2) {
        for(t8 = 0; t8 <= C-1; t8++) {
          s4(t8,t2,t4,t6);
        }
      }
      else {
        if (t6 <= -2) {
          for(t8 = 0; t8 <= C-1; t8++) {
            s4(t8,t2,t4,t6);
          }
        }
        else {
          for(t8 = 0; t8 <= C-1; t8++) {
            s2(t8,t2-1,t4,t6-1);
            s4(t8,t2,t4,t6);
          }
        }
      }
      if (t2 >= -1 && t6 >= -1) {
        s3(t2-1,t4,t6-1);
      }
    }
  }
}

// lap_f_d2+inc_f_d2+div_f_d2+inc_rhs_d2
#undef s0
#define s0(c,z,y,x) F_lap_f_d2((c),(z),(y),(x))=((-0.166667)*F_bar_f_d2((c),(z),(y),(x)))+(0.041667*F_bar_f_d2((c),(z),(y),(x)+1))+(0.041667*F_bar_f_d2((c),(z),(y),(x)-1))+(0.041667*F_bar_f_d2((c),(z)+1,(y),(x)))+(0.041667*F_bar_f_d2((c),(z)-1,(y),(x)))
#undef s1
#define s1(c,z,y,x) F_ave_f_d2((c),(z),(y),(x))+=F_lap_f_d2((c),(z),(y),(x))
#undef s2
#define s2(c,z,y,x) F_div_f_d2((c),(z),(y),(x))=((-1.000000)*F_ave_f_d2((c),(z),(y),(x)))+(1.000000*F_ave_f_d2((c),(z),(y)+1,(x)))
#undef s3
#define s3(c,z,y,x) rhs((c),(z),(y),(x))+=F_div_f_d2((c),(z),(y),(x))

//#pragma omp parallel for schedule(auto) private(t2,t4,t6,t8)
for(t2 = 0; t2 <= C-1; t2++) {
  for(t4 = -2; t4 <= N+1; t4++) {
    for(t6 = 0; t6 <= N; t6++) {
      if (t6 <= 0) {
        #pragma omp simd
        for(t8 = -2; t8 <= N+1; t8++) {
          s0(t2,t4,t6,t8);
          s1(t2,t4,t6,t8);
        }
      }
      else {
        if (t4 <= -1) {
          #pragma omp simd
          for(t8 = -2; t8 <= N+1; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s2(t2,t4,t6-1,t8);
          }
        }
        else {
          if (N >= t4+1) {
            #pragma omp simd
            for(t8 = -2; t8 <= -1; t8++) {
              s0(t2,t4,t6,t8);
              s1(t2,t4,t6,t8);
              s2(t2,t4,t6-1,t8);
            }
            #pragma omp simd
            for(t8 = 0; t8 <= N-1; t8++) {
              s0(t2,t4,t6,t8);
              s1(t2,t4,t6,t8);
              s2(t2,t4,t6-1,t8);
              s3(t2,t4,t6-1,t8);
            }
            #pragma omp simd
            for(t8 = N; t8 <= N+1; t8++) {
              s0(t2,t4,t6,t8);
              s1(t2,t4,t6,t8);
              s2(t2,t4,t6-1,t8);
            }
          }
        }
        if (t4 >= N) {
          #pragma omp simd
          for(t8 = -2; t8 <= N+1; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s2(t2,t4,t6-1,t8);
          }
        }
      }
    }
  }
}

// upwindState3+getFlux5+deconvolve_f_d3+getFlux6+smul_d3
#undef s0
#define s0(z,y,x) {\
W_ave_f_d3(0,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(0,(z),(y),(x))) : (W_aveH_d3(0,(z),(y),(x)));\
W_ave_f_d3(1,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(1,(z),(y),(x))) : (W_aveH_d3(1,(z),(y),(x)));\
W_ave_f_d3(2,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(2,(z),(y),(x))) : (W_aveH_d3(2,(z),(y),(x)));\
W_ave_f_d3(3,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(3,(z),(y),(x))) : (W_aveH_d3(3,(z),(y),(x)));\
W_ave_f_d3(4,(z),(y),(x))=(0.000000 < ((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) ? (W_aveL_d3(4,(z),(y),(x))) : (W_aveH_d3(4,(z),(y),(x)));\
W_ave_f_d3(0,(z),(y),(x))+=(0.000000 < sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000) ? (((((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000+((((((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))*(W_aveL_d3(2+1,(z),(y),(x))-W_aveH_d3(2+1,(z),(y),(x))))*0.500000-W_ave_f_d3(4,(z),(y),(x))))/((sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000)))*sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000)))) : (0.000000);\
W_ave_f_d3(2+1,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))) : (W_ave_f_d3(2+1,(z),(y),(x)));\
W_ave_f_d3(4,(z),(y),(x))=(0.000000 < sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))+(-sgn(((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000+((W_aveL_d3(4,(z),(y),(x))-W_aveH_d3(4,(z),(y),(x))))/((2.000000*(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))))*((W_aveL_d3(2+1,(z),(y),(x))+W_aveH_d3(2+1,(z),(y),(x))))*0.500000) ? (((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000+((((((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))*(sqrt((1.400000*(((W_aveL_d3(4,(z),(y),(x))+W_aveH_d3(4,(z),(y),(x))))*0.500000))/(((W_aveL_d3(0,(z),(y),(x))+W_aveH_d3(0,(z),(y),(x))))*0.500000))))*(W_aveL_d3(2+1,(z),(y),(x))-W_aveH_d3(2+1,(z),(y),(x))))*0.500000) : (W_ave_f_d3(4,(z),(y),(x)));\
}
#undef s1
#define s1(z,y,x) {\
F_bar_f_d3(0,(z),(y),(x))=(W_ave_f_d3(2+1,(z),(y),(x)))*W_ave_f_d3(0,(z),(y),(x));\
F_bar_f_d3(1,(z),(y),(x))=W_ave_f_d3(1,(z),(y),(x))*F_bar_f_d3(0,(z),(y),(x));\
F_bar_f_d3(2,(z),(y),(x))=W_ave_f_d3(2,(z),(y),(x))*F_bar_f_d3(0,(z),(y),(x));\
F_bar_f_d3(3,(z),(y),(x))=W_ave_f_d3(3,(z),(y),(x))*F_bar_f_d3(0,(z),(y),(x));\
F_bar_f_d3(2+1,(z),(y),(x))+=W_ave_f_d3(4,(z),(y),(x));\
F_bar_f_d3(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_ave_f_d3(2+1,(z),(y),(x)))*W_ave_f_d3(4,(z),(y),(x))+0.500000*F_bar_f_d3(0,(z),(y),(x))*((W_ave_f_d3(1,(z),(y),(x))*W_ave_f_d3(1,(z),(y),(x)))+(W_ave_f_d3(2,(z),(y),(x))*W_ave_f_d3(2,(z),(y),(x)))+(W_ave_f_d3(3,(z),(y),(x))*W_ave_f_d3(3,(z),(y),(x))));\
}
#undef s2
#define s2(c,z,y,x) W_f_d3((c),(z),(y),(x))=(1.166667*W_ave_f_d3((c),(z),(y),(x)))+((-0.041667)*W_ave_f_d3((c),(z),(y),(x)+1))+((-0.041667)*W_ave_f_d3((c),(z),(y),(x)-1))+((-0.041667)*W_ave_f_d3((c),(z),(y)+1,(x)))+((-0.041667)*W_ave_f_d3((c),(z),(y)-1,(x)))
#undef s3
#define s3(z,y,x) {\
F_ave_f_d3(0,(z),(y),(x))=(W_f_d3(2+1,(z),(y),(x)))*W_f_d3(0,(z),(y),(x));\
F_ave_f_d3(1,(z),(y),(x))=W_f_d3(1,(z),(y),(x))*F_ave_f_d3(0,(z),(y),(x));\
F_ave_f_d3(2,(z),(y),(x))=W_f_d3(2,(z),(y),(x))*F_ave_f_d3(0,(z),(y),(x));\
F_ave_f_d3(3,(z),(y),(x))=W_f_d3(3,(z),(y),(x))*F_ave_f_d3(0,(z),(y),(x));\
F_ave_f_d3(2+1,(z),(y),(x))+=W_f_d3(4,(z),(y),(x));\
F_ave_f_d3(4,(z),(y),(x))=((1.400000/(1.400000-1))*W_f_d3(2+1,(z),(y),(x)))*W_f_d3(4,(z),(y),(x))+0.500000*F_ave_f_d3(0,(z),(y),(x))*((W_f_d3(1,(z),(y),(x))*W_f_d3(1,(z),(y),(x)))+(W_f_d3(2,(z),(y),(x))*W_f_d3(2,(z),(y),(x)))+(W_f_d3(3,(z),(y),(x))*W_f_d3(3,(z),(y),(x))));\
}
#undef s4
#define s4(c,z,y,x) F_bar_f_d3((c),(z),(y),(x))*=0.041667

//#pragma omp parallel for schedule(auto) private(t2,t4,t6,t8)
for(t2 = 0; t2 <= N; t2++) {
  for(t4 = -3; t4 <= N+2; t4++) {
    #pragma omp simd
    for(t6 = -3; t6 <= N+2; t6++) {
      s0(t2,t4,t6);
      s1(t2,t4,t6);
      if (t4 <= -2) {
        for(t8 = 0; t8 <= C-1; t8++) {
          s4(t8,t2,t4,t6);
        }
      }
      else {
        if (t6 <= -2) {
          for(t8 = 0; t8 <= C-1; t8++) {
            s4(t8,t2,t4,t6);
          }
        }
        else {
          for(t8 = 0; t8 <= C-1; t8++) {
            s2(t8,t2,t4-1,t6-1);
            s4(t8,t2,t4,t6);
          }
        }
      }
      if (t4 >= -1 && t6 >= -1) {
        s3(t2,t4-1,t6-1);
      }
    }
  }
}

// lap_f_d3+inc_f_d3+div_f_d3+inc_rhs_d3+muldx
#undef s0
#define s0(c,z,y,x) F_lap_f_d3((c),(z),(y),(x))=((-0.166667)*F_bar_f_d3((c),(z),(y),(x)))+(0.041667*F_bar_f_d3((c),(z),(y),(x)+1))+(0.041667*F_bar_f_d3((c),(z),(y),(x)-1))+(0.041667*F_bar_f_d3((c),(z),(y)+1,(x)))+(0.041667*F_bar_f_d3((c),(z),(y)-1,(x)))
#undef s1
#define s1(c,z,y,x) F_ave_f_d3((c),(z),(y),(x))+=F_lap_f_d3((c),(z),(y),(x))
#undef s2
#define s2(c,z,y,x) F_div_f_d3((c),(z),(y),(x))=((-1.000000)*F_ave_f_d3((c),(z),(y),(x)))+(1.000000*F_ave_f_d3((c),(z)+1,(y),(x)))
#undef s3
#define s3(c,z,y,x) rhs((c),(z),(y),(x))+=F_div_f_d3((c),(z),(y),(x))
#undef s4
#define s4(c,z,y,x) rhs((c),(z),(y),(x))*=-1.000000

//#pragma omp parallel for schedule(auto) private(t2,t4,t6,t8)
for(t2 = 0; t2 <= C-1; t2++) {
  for(t4 = 0; t4 <= N; t4++) {
    for(t6 = -2; t6 <= N+1; t6++) {
      if (t4 <= 0) {
        #pragma omp simd
        for(t8 = -2; t8 <= -1; t8++) {
          s0(t2,t4,t6,t8);
          s1(t2,t4,t6,t8);
        }
        if (t6 <= -1) {
          #pragma omp simd
          for(t8 = 0; t8 <= N-1; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
          }
        }
        else {
          if (N >= t6+1) {
            #pragma omp simd
            for(t8 = 0; t8 <= N-1; t8++) {
              s0(t2,t4,t6,t8);
              s1(t2,t4,t6,t8);
              s4(t2,t4,t6,t8);
            }
          }
        }
        if (t6 >= N) {
          #pragma omp simd
          for(t8 = 0; t8 <= N-1; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
          }
        }
        #pragma omp simd
        for(t8 = N; t8 <= N+1; t8++) {
          s0(t2,t4,t6,t8);
          s1(t2,t4,t6,t8);
        }
      }
      else {
        if (t6 <= -1) {
          #pragma omp simd
          for(t8 = -2; t8 <= N+1; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s2(t2,t4-1,t6,t8);
          }
        }
        else {
          if (N >= t6+1) {
            #pragma omp simd
            for(t8 = -2; t8 <= -1; t8++) {
              s0(t2,t4,t6,t8);
              s1(t2,t4,t6,t8);
              s2(t2,t4-1,t6,t8);
            }
            if (N >= t4+1) {
              #pragma omp simd
              for(t8 = 0; t8 <= N-1; t8++) {
                s0(t2,t4,t6,t8);
                s1(t2,t4,t6,t8);
                s2(t2,t4-1,t6,t8);
                s3(t2,t4-1,t6,t8);
                s4(t2,t4,t6,t8);
              }
            }
          }
          if (t4 >= t6+1 && t4 >= N) {
            #pragma omp simd
            for(t8 = 0; t8 <= t4-1; t8++) {
              s0(t2,t4,t6,t8);
              s1(t2,t4,t6,t8);
              s2(t2,t4-1,t6,t8);
              s3(t2,t4-1,t6,t8);
            }
          }
          if (N >= t6+1) {
            #pragma omp simd
            for(t8 = N; t8 <= N+1; t8++) {
              s0(t2,t4,t6,t8);
              s1(t2,t4,t6,t8);
              s2(t2,t4-1,t6,t8);
            }
          }
        }
        if (t6 >= N) {
          #pragma omp simd
          for(t8 = -2; t8 <= N+1; t8++) {
            s0(t2,t4,t6,t8);
            s1(t2,t4,t6,t8);
            s2(t2,t4-1,t6,t8);
          }
        }
      }
    }
  }
}

    free(array11);
    free(array10);
    free(array9);
    free(array8);
    free(array7);
    free(array6);
    free(array5);
    free(array4);
    free(array3);
    free(array1);

    return (retval);
}    // euler_step

#undef min
#undef max
#undef abs
#undef absmin
#undef absmax
#undef floord
#undef sgn
#undef offset2
#undef offset3
#undef offset4
#undef arrinit
#undef arrprnt
#undef C
#undef D
#undef G
#undef N
#undef U
#undef W_bar
#undef u
#undef W
#undef umax
#undef W_ave
#undef W_aveL_d1
#undef W_aveH_d1
#undef W_aveL_d2
#undef W_aveH_d2
#undef W_aveL_d3
#undef W_aveH_d3
#undef W_ave_f_d1
#undef F_bar_f_d1
#undef W_f_d1
#undef F_ave_f_d1
#undef F_lap_f_d1
#undef F_div_f_d1
#undef rhs
#undef W_ave_f_d2
#undef F_bar_f_d2
#undef W_f_d2
#undef F_ave_f_d2
#undef F_lap_f_d2
#undef F_div_f_d2
#undef W_ave_f_d3
#undef F_bar_f_d3
#undef W_f_d3
#undef F_ave_f_d3
#undef F_lap_f_d3
#undef F_div_f_d3

